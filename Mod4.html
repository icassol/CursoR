<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Gráficos</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<div class="header">
  <img class="center-fit" src="./resources/curso-banner.png" />
</div>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Curso R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Mod1.html">Introducción</a>
</li>
<li>
  <a href="Mod2.html">Lenguaje R</a>
</li>
<li>
  <a href="Mod3.html">Estadística</a>
</li>
<li>
  <a href="Mod4.html">Gráficos</a>
</li>
<li>
  <a href="Mod5.html">Reportes</a>
</li>
<li>
  <a href="Mod6.html">Web</a>
</li>
<li>
  <a href="Mod7.html">Regresión</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Gráficos</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduccion"><span class="toc-section-number">1</span> Introducción</a><ul>
<li><a href="#funciones-graficas-de-alto-nivel"><span class="toc-section-number">1.1</span> Funciones gráficas de alto nivel</a></li>
<li><a href="#funciones-graficas-de-bajo-nivel"><span class="toc-section-number">1.2</span> Funciones gráficas de bajo nivel:</a></li>
<li><a href="#argumentos-comunes-a-las-funciones-graficas-de-alto-y-bajo-nivel"><span class="toc-section-number">1.3</span> Argumentos comunes a las funciones gráficas de alto y bajo nivel</a></li>
</ul></li>
<li><a href="#exportacion-de-una-grafica"><span class="toc-section-number">2</span> Exportación de una gráfica</a></li>
<li><a href="#algunos-ejemplos"><span class="toc-section-number">3</span> Algunos ejemplos</a><ul>
<li><a href="#plot"><span class="toc-section-number">3.1</span> plot()</a></li>
<li><a href="#hist"><span class="toc-section-number">3.2</span> hist()</a></li>
<li><a href="#barplot"><span class="toc-section-number">3.3</span> barplot()</a></li>
<li><a href="#pie"><span class="toc-section-number">3.4</span> pie()</a></li>
<li><a href="#comparacion-de-funciones-de-densidad"><span class="toc-section-number">3.5</span> comparación de funciones de densidad</a></li>
<li><a href="#violin-plot"><span class="toc-section-number">3.6</span> Violin plot</a></li>
<li><a href="#boxplot"><span class="toc-section-number">3.7</span> boxplot()</a></li>
</ul></li>
<li><a href="#mapas-de-calor"><span class="toc-section-number">4</span> Mapas de calor</a><ul>
<li><a href="#mapas-de-calor-con-agrupamiento"><span class="toc-section-number">4.1</span> Mapas de calor con agrupamiento:</a></li>
</ul></li>
<li><a href="#dendogramas"><span class="toc-section-number">5</span> Dendogramas</a><ul>
<li><a href="#particionamiento-del-dendograma"><span class="toc-section-number">5.1</span> Particionamiento del dendograma</a></li>
</ul></li>
<li><a href="#importancia-de-los-colores"><span class="toc-section-number">6</span> Importancia de los colores</a><ul>
<li><a href="#un-poco-de-teoria"><span class="toc-section-number">6.1</span> Un poco de teoría</a></li>
<li><a href="#el-paquete-colortools"><span class="toc-section-number">6.2</span> El paquete <code>colortools</code></a></li>
</ul></li>
</ul>
</div>

<!-- see http://rmarkdown.rstudio.com/ for details in formatting -->
<div id="introduccion" class="section level1">
<h1><span class="header-section-number">1</span> Introducción</h1>
<p>R dispone de múltiples funciones diseñadas para la representación gráfica de datos. Estas funciones se dividen en dos grandes grupos: funciones gráficas de alto nivel y de bajo nivel. La diferencia fundamental es que las funciones de alto nivel son las que generan gráficos completos, mientras que las de bajo nivel se limitan a añadir elementos a un gráfico existente (por tanto creado por una función de alto nivel).</p>
<p>Una página de referencia, con múltiples paquetes y ejemplos para hacer gráficos en R está en <a href="https://www.r-graph-gallery.com/">este link</a>. Allí hay gráficos para representar: Distribuciones, Correlaciones, Rankings, Parte de un todo, Evolución, Mapas, Flujos, entre otros.</p>
<p>El paquete <code>graphics</code> (que se carga en memoria cada vez que se ejecuta R) contiene un buen número de funciones de alto y bajo nivel para generar gráficos. Existe una gran variedad de paquetes -<code>plotrix</code>, <code>scatterplot3D</code>, <code>rgl</code>, <code>maps</code>, <code>shapes</code>, y sobre todo <code>ggplot2</code>- que contienen muchísimas más funciones gráficas que mejoran y complementan las que vienen por defecto con R.</p>
<div id="funciones-graficas-de-alto-nivel" class="section level2">
<h2><span class="header-section-number">1.1</span> Funciones gráficas de alto nivel</h2>
<p>Estas funciones son las que generan gráficos completos. Entre las más utilizadas podemos citar ´plot()´ (gráficos de nubes de puntos, entre otros), <code>hist()</code> (histogramas), <code>barplot()</code> (diagramas de barras), <code>boxplot()</code> (diagramas de caja y bigote), <code>pie()</code> (diagrama de sectores) o <code>pers()</code> (superficies en 3D). Todas estas funciones disponen de multitud de argumentos que permiten controlar las etiquetas de los ejes, sus límites, títulos, tamaño, colores. Listamos los argumentos más relevantes:</p>
<ul>
<li><p><code>xlim</code>, <code>ylim</code>: controlan, respectivamente, la extensión de los ejes X e Y. Así <code>xlim=c(0,10)</code> indica que el eje X se extiende de 0 a 10; <code>ylim=c(-5,5)</code> indica que el eje Y va de -5 a 5. Si no se incluyen estos valores, R los ajusta por defecto de modo que se incluyan todos los valores disponibles en el dataframe.</p></li>
<li><p><code>xlab</code> e <code>ylab</code>: especifican las etiquetas para los ejes X e Y respectivamente.</p></li>
<li><p><code>main</code>: indica el título del gráfico.</p></li>
<li><p><code>sub</code>: permite especificar un subtítulo.</p></li>
</ul>
<p>Los ejemplos que se muestran más abajo permiten ver cómo utilizar estas opciones.</p>
<p>Dos argumentos importantes que son comunes a la mayoría de gráficos de alto nivel son los siguientes:</p>
<ul>
<li><p><code>add=TRUE</code>: fuerza a la función a actuar como si fuese de bajo nivel (intenta superponer la figura que genera a un gráfico ya existente). Esta opción no está disponible para todas las funciones.</p></li>
<li><p><code>type</code> Indica el tipo de gráfico a realizar. En concreto:</p>
<ul>
<li>type=“p” representa puntos (opción por defecto)</li>
<li>type=“l” representa líneas</li>
<li>type=“b” (both, ambos) representa puntos unidos por líneas.</li>
<li>type=“n” No dibuja nada.</li>
</ul></li>
</ul>
</div>
<div id="funciones-graficas-de-bajo-nivel" class="section level2">
<h2><span class="header-section-number">1.2</span> Funciones gráficas de bajo nivel:</h2>
<p>Permiten añadir líneas, puntos, etiquetas, etc. a un gráfico ya existente. Son de gran utilidad para completar un gráfico. Entre estas funciones cabe destacar:</p>
<ul>
<li><p><code>lines()</code>: Permite añadir lineas (uniendo puntos concretos) a una gráfica ya existente.</p></li>
<li><p><code>abline()</code>: Añade lineas horizontales, verticales u oblicuas, indicando pendiente y ordenada.</p></li>
<li><p><code>points()</code>: Permite añadir puntos.</p></li>
<li><p><code>legend()</code>: Permite añadir una leyenda.</p></li>
<li><p><code>text()</code>: Añade texto en las posiciones que se indiquen.</p></li>
<li><p><code>grid()</code>: Añade una malla de fondo.</p></li>
<li><p><code>title()</code>: permite añadir un título o subtítulo.</p></li>
</ul>
</div>
<div id="argumentos-comunes-a-las-funciones-graficas-de-alto-y-bajo-nivel" class="section level2">
<h2><span class="header-section-number">1.3</span> Argumentos comunes a las funciones gráficas de alto y bajo nivel</h2>
<p>Los siguientes argumentos opcionales son comunes a muchas funciones gráficas de alto y bajo nivel. Sus valores por defecto pueden obtenerse ejecutando la función par(). Se puede encontrar el significado y valores posibles de cada uno de estos argumentos (y muchos más) ejecutando help(par).</p>
<ul>
<li><p><code>pch</code>: Indica la forma en que se dibujaran los puntos (círculo, cuadrado, estrella, etc). El listado de valores y formas disponibles puede verse mediante help(points)</p></li>
<li><p><code>lty</code>: Indica la forma en que se dibujan las líneas (continua, a trazos, …).</p></li>
<li><p><code>lwd</code>: Ancho de las líneas.</p></li>
<li><p><code>col</code>: Color usado para el gráfico (ya sea para puntos, líneas…). Puede vers un listado completo de los colores disponibles en R ejecutando la función colors(). help(colors) explica como obtener aún más colores. Este documento contiene una muestra de cada color.</p></li>
<li><p><code>font</code>: Fuente a usar en el texto.</p></li>
<li><p><code>las</code>: Cambia el estilo de las etiquetas de los ejes (0 paralelo a los ejes, 1 siempre horizontales, 2, perpendiculares a los ejes, 3 siempre verticales)</p></li>
</ul>
</div>
</div>
<div id="exportacion-de-una-grafica" class="section level1">
<h1><span class="header-section-number">2</span> Exportación de una gráfica</h1>
<p>La gráfica se puede observar con más detalle haciendo click en “Zoom”, en área de Files. Y, haciendo click en “Export”, se puede guardar el gráfico en formato .png.</p>
<hr />
</div>
<div id="algunos-ejemplos" class="section level1">
<h1><span class="header-section-number">3</span> Algunos ejemplos</h1>
<div id="plot" class="section level2">
<h2><span class="header-section-number">3.1</span> plot()</h2>
<p>Esta función ofrece muchas variantes dependiendo del tipo de objeto al que se aplique. El caso más simple corresponde a la representación de dos variables x e y. En tal caso, plot(x,y) representa un diagrama de dispersión de puntos de y frente a x. Veamos ejemplos muy simples:</p>
<pre class="r"><code>a&lt;-rep(1:10) # = (1,2,3,4,5,6,7,8,9,10)
b&lt;-rep(1,10) # = (1,1,1,1,1,1,1,1,1,1)
par(mfrow=c(1,3)) # creamos una matriz de gráficos de 1x2
plot(a,b, pch=1) # asignamos este gráfico al 1er panel de la matriz
plot(a,a, pch=2) # asignamos este gráfico al 2do panel de la matriz
plot(b,a, pch=3) # asignamos este gráfico al 3do panel de la matriz</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-1-1.png" width="432" /></p>
<p>A modo de ejemplo se muestra a continuación un gráfico de la esperanza de vida (<strong><em>LifeExpectancy</em></strong>, la variable dependiente y) frente al índice de felicidad (<strong><em>Happiness</em></strong>, la variable independiente x) en una muestra de 143 países. Los datos se encuentran en el dataframe <code>HappyPlanetIndex</code> del paquete <code>Lock5Data</code>. Para ver las variables de este dataframe: <code>help(HappyPlanetIndex)</code> y para conocer más datos sobre este estudio, <a href="http://www.happyplanetindex.org/about/">ir a este link</a>. Cargamos los datos y los graficamos con <code>plot()</code>:</p>
<pre class="r"><code>if (!is.element(&quot;Lock5Data&quot;, installed.packages()[,1])){
  install.packages(&quot;Lock5Data&quot;)
}
library(Lock5Data)
data(HappyPlanetIndex) # indicamos que cargue en memoria, específicamente, el dataset HappyPlanetIndex 
attach(HappyPlanetIndex) # para entender esta función, buscar ?attach
plot(Happiness,LifeExpectancy,pch=19,col=&quot;red&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-2-1.png" width="432" /></p>
<div id="ejemplo-de-plot" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Ejemplo de <code>plot()</code></h3>
<p>Para ver un ejemplo utilizaremos el dataframe <code>trees</code>, disponible en el paquete <code>datasets</code>. Este dataframe contiene datos de tres variables medidas en una muestra de 31 cerezos: Girth (diámetro del tronco en pulgadas), Height (altura del árbol en pies) y Volume (volumen de madera en el árbol). Mostramos los datos a continuación:</p>
<pre class="r"><code>data(trees)
head(trees)</code></pre>
<pre><code>##   Girth Height Volume
## 1   8.3     70   10.3
## 2   8.6     65   10.3
## 3   8.8     63   10.2
## 4  10.5     72   16.4
## 5  10.7     81   18.8
## 6  10.8     83   19.7</code></pre>
<p>El comando <code>plot()</code> ejecutado directamente sobre el dataframe muestra las nubes de puntos correspondientes a todas las posibles parejas de variables:</p>
<pre class="r"><code>plot(trees)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-4-1.png" width="432" /></p>
<p>Si sólo deseamos representar la altura del árbol frente al diámetro del tronco, especificamos simplemente estas dos variables:</p>
<pre class="r"><code>with(trees,plot(Girth,Height))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-5-1.png" width="432" /></p>
</div>
</div>
<div id="hist" class="section level2">
<h2><span class="header-section-number">3.2</span> hist()</h2>
<p>Un histograma es una representación gráfica de la distribución de frecuencias de una variable continua. Consiste en una sucesión de rectángulos levantados sobre un eje que representa los valores de la variable. Cada rectángulo tiene un área proporcional a la frecuencia de valores observada en el intervalo sobre el que se levanta. En esta sección aprenderemos a construir un histograma con R.</p>
<p>Con <code>hist()</code> dibujamos un histograma. Por ejemplo, el histograma de los niveles de felicidad en los distintos países se puede obtiene de esta manera:</p>
<pre class="r"><code>data(HappyPlanetIndex)
attach(HappyPlanetIndex)
hist(Happiness,col=&quot;darkolivegreen1&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-6-1.png" width="432" /></p>
<p>En el mismo paquete <code>Lock5Data</code> podemos encontrar el dataframe <code>SalaryGender</code> que contiene una muestra de 100 profesores universitarios de EEUU, 50 hombres y 50 mujeres; para cada uno se tiene el salario anual (en miles de dólares), la edad y la variable PhD que vale 1 si el profesor es doctor y 0 si no lo es. Podemos ver la distribución de salarios entre hombres y mujeres mediante un histograma combinado utilizando la función <code>histStack()</code> del paquete <code>plotrix</code>:</p>
<pre class="r"><code>data(SalaryGender)
attach(SalaryGender)
Salary&lt;-SalaryGender[,1]
Gender&lt;-factor(SalaryGender[,2],levels=c(0,1),labels=c(&quot;Female&quot;,&quot;Male&quot;))
library(plotrix)
histStack(Salary,Gender,legend.pos=&quot;topright&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-7-1.png" width="432" /></p>
<div id="ejemplo-de-histograma" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Ejemplo de histograma</h3>
<p>Vamos a ver un ejemplo de histograma al que le vamos a superponer una distribución de probabilidad teórica y otra estimada no paramétricamente, a insertar títulos, etiquetas, etc.</p>
<p>Usaremos los pacientes de cancer de mama (BRCA_all_data). En concreto, nos interesa ver el histograma de las edades de las pacientes.</p>
<p><img src="Mod4_files/figure-html/unnamed-chunk-8-1.png" width="432" /></p>
<ol style="list-style-type: decimal">
<li>Construcción del histograma básico</li>
</ol>
<p>Consultar la ayuda: <code>help(hist)</code>. Para empezar,debemos pasar a la función hist los datos de la variable a representar, en nuestro caso la variable <code>age_at_initial_pathologic_diagnosis</code>.</p>
<pre class="r"><code>hist(BRCA_all_data$age_at_initial_pathologic_diagnosis, main=&quot;Histograma de la edad de las pacientes&quot;,xlab=&quot;&quot;,ylab=&quot;Densidad&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-9-1.png" width="432" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Definición del eje de ordenadas en frecuencias relativas y color del histograma</li>
</ol>
<p>El eje de ordenadas muestra por defecto frecuencias absolutas; el gráfico que queremos construir es con frecuencias relativas en este eje. Para ello utilizamos la opción freq=FALSE; además le damos color al histograma mediante col=“lightcyan”</p>
<pre class="r"><code>hist(BRCA_all_data$age_at_initial_pathologic_diagnosis,freq=FALSE, col=&quot;lightcyan&quot;, main=&quot;Histograma de la edad de las pacientes&quot;,xlab=&quot;&quot;,ylab=&quot;Densidad&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-10-1.png" width="432" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Incremento de la longitud del eje de ordenadas</li>
</ol>
<p>Para que en la gráfica haya espacio para la leyenda, alargamos el eje de ordenadas mediante la opción ylim:</p>
<pre class="r"><code>hist(BRCA_all_data$age_at_initial_pathologic_diagnosis,freq=FALSE, col=&quot;lightcyan&quot;,ylim=c(0,0.05), main=&quot;Histograma de la edad de las pacientes&quot;,xlab=&quot;&quot;,ylab=&quot;Densidad&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-11-1.png" width="432" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Estimación de la función de densidad de la variable mediante un estimador de nucleo</li>
</ol>
<p>El estimador de núcleo de la función de densidad del peso eviscerado se calcula mediante <code>density(BRCA_all_data$age_at_initial_pathologic_diagnosis)</code>. Para superponer esta función al histograma utilizaremos la función de bajo nivel <code>lines</code>; además dibujamos la línea con grosor <code>lwd=2</code> y de color rojo:</p>
<pre class="r"><code>hist(BRCA_all_data$age_at_initial_pathologic_diagnosis,freq=FALSE, col=&quot;lightcyan&quot;,ylim=c(0,0.05), main=&quot;Histograma de la edad de las pacientes&quot;,xlab=&quot;&quot;,ylab=&quot;Densidad&quot;)
lines(density(BRCA_all_data$age_at_initial_pathologic_diagnosis),col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-12-1.png" width="432" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Ajuste de una función de densidad normal con media y desviación estándar estimadas a partir de los datos</li>
</ol>
<p>Ajustamos también a nuestros datos una función de densidad normal con media igual a la media estimada de la edad y desviación típica también igual a la observada en la muestra.</p>
<pre class="r"><code>hist(BRCA_all_data$age_at_initial_pathologic_diagnosis,freq=FALSE, col=&quot;lightcyan&quot;,ylim=c(0,0.05), main=&quot;Histograma de la edad de las pacientes&quot;,xlab=&quot;&quot;,ylab=&quot;Densidad&quot;)
lines(density(BRCA_all_data$age_at_initial_pathologic_diagnosis),col=&quot;red&quot;,lwd=2)
curve(dnorm(x,mean=mean(BRCA_all_data$age_at_initial_pathologic_diagnosis),sd=sd(BRCA_all_data$age_at_initial_pathologic_diagnosis)), 
      add=TRUE, col=&quot;blue&quot;, lwd=2)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-13-1.png" width="432" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Leyenda</li>
</ol>
<p>Por último añadimos una leyenda explicando qué representa cada curva:</p>
<p><img src="Mod4_files/figure-html/unnamed-chunk-14-1.png" width="432" /></p>
</div>
</div>
<div id="barplot" class="section level2">
<h2><span class="header-section-number">3.3</span> barplot()</h2>
<p>Se utiliza para dibujar diagramas de barras. El siguiente ejemplo muestra el número de países en cada una de las 7 regiones en que se dividió el planeta para el estudio de los niveles de felicidad:</p>
<pre class="r"><code>library(Lock5Data)
data(HappyPlanetIndex)
attach(HappyPlanetIndex)
barplot(table(Region),xlab=&quot;Region&quot;,main=&quot;Happiness level by region&quot;, col=rainbow(10))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-15-1.png" width="432" /></p>
<p>El paquete <code>plotrix</code> contiene la función <code>barp()</code> que permite dar “volumen” a la barras:</p>
<pre class="r"><code>library(Lock5Data)
data(HappyPlanetIndex)
attach(HappyPlanetIndex)
barp(table(Region), col=&quot;lightblue&quot;, cylindrical=TRUE, shadow=TRUE)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-16-1.png" width="432" /></p>
<p>Es posible construir diagramas de barras por categorías. Podemos, por ejemplo representar la frecuencia de doctores por sexo utilizando los datos del dataframe <code>SalaryGender</code>:</p>
<pre class="r"><code>data(SalaryGender)
attach(SalaryGender)
PhD&lt;-factor(PhD,levels=c(0,1),labels=c(&quot;PhD&quot;,&quot;non PhD&quot;))
barplot(table(Gender,PhD),beside=TRUE,legend.text=TRUE,col=c(&quot;pink&quot;,&quot;cyan&quot;))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-17-1.png" width="432" /></p>
<div id="ejemplo-de-barplot" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Ejemplo de <code>barplot()</code></h3>
<p>Para ver este gráfico usaremos los pacientes de cancer de mama (BRCA_all_data). En concreto, nos interesa ver el porcentaje de pacientes vivos y muertos.</p>
<p>Nuestro objetivo en esta sección será construir el siguiente diagrama de barras con la variable <code>vital_status</code>. A esta gráfica la denominaremos “gráfica patrón” a lo largo del texto.</p>
<p><img src="Mod4_files/figure-html/unnamed-chunk-18-1.png" width="432" /></p>
<ol style="list-style-type: decimal">
<li>Primer Paso</li>
</ol>
<p>Para empezar, debemos pasar como argumento a dicha función los datos de la variable que queremos representar. En concreto, debemos especificar las frecuencias relativas de las categorías presentes en la variable especie. El cálculo de las frecuencias relativas se realiza a través de las funciones <code>table()</code> y <code>prop.table()</code>.</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-19-1.png" width="432" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Color</li>
</ol>
<p>En la gráfica anterior ya tenemos representado el mismo contenido que en la gráfica patrón. Vamos ahora a darle color. El argumento que controla los colores de las barras del barplot es ´col´:</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-20-1.png" width="432" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Leyenda</li>
</ol>
<p>Ahora añadimos una leyenda utilizando el argumento <code>legend.text</code>:</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-21-1.png" width="432" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Ajustando los ejes para dejar sitio a la leyenda</li>
</ol>
<p>La leyenda que que acabamos de colocar “pisa” una de las barras del gráfico. En la gráfica patrón podemos observar que el eje de ordenadas tiene una amplitud mayor, que va de 0 a 0.8 unidades. Para cambiar los límites del eje de ordenadas utilizamos el argumento <code>ylim</code>:</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;),ylim=c(0,0.8))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-22-1.png" width="432" /></p>
<p>Otra opción es ampliar el eje X, de modo que quede sitio a la izquierda para colocar la leyenda. El problema, en principio, es que como este es un eje de categorías, no muestra valores numéricos, así que ¿como lo ampliamos?. La solución estriba en saber que barplotdevuelve de modo invisible las coordenadas de las posiciones de la base. La manera de capturar dichas coordenadas es asignar el gráfico a una variable y mostrar los valores de ésta (si además indicamos plot=FALSE nos ahorramos que R nos repita el gráfico, aunque tampoco tiene mayor importancia):</p>
<pre class="r"><code>xCoords&lt;-barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;),ylim=c(0,0.8), plot=FALSE)
xCoords</code></pre>
<pre><code>##      [,1]
## [1,]  0.7
## [2,]  1.9</code></pre>
<p>Vemos, por tanto, que las barras están en las posiciones 0.7 y 1.9. Probamos a reconstruir el gráfico fijando la extensión del eje X como <code>xlim=c(0,3.3)</code> (si no quedamos satisfechos de entrada podemos probar unos cuantos valores):</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;),xlim=c(0,3.3))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-24-1.png" width="432" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Título</li>
</ol>
<p>El título se especifica mediante la opción main, escribiendo el texto del título entre comillas:</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;),ylim=c(0,0.8),main=&quot;Mujeres con cancer de mama&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-25-1.png" width="432" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Texto en el eje de ordenadas</li>
</ol>
<p>Mediante el argumento ylab especificamos el texto (también entre comillas) que deseamos como etiqueta del eje Y:</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;),ylim=c(0,0.8),main=&quot;Mujeres con cancer de mama&quot;,   ylab =&quot;Frecuencias Relativas&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-26-1.png" width="432" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Orientación de las etiquetas en los ejes</li>
</ol>
<p>El párametro cambia la orientación de las etiquetas del eje de ordenadas (consultar help(par) para ver las distintas opciones)</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;),ylim=c(0,0.8),main=&quot;Mujeres con cancer de mama&quot;,   ylab =&quot;Frecuencias Relativas&quot;,las=1)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-27-1.png" width="432" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Cambio de la fuente para las letras de las etiquetas</li>
</ol>
<p>Para cambiar el tipo de fuente que se usa en las letras de las etiquetas del eje de abscisas se utiliza el argumento font.axis (consultar help(par) para ver las distinas fuentes posibles)</p>
<pre class="r"><code>barplot(prop.table(table(BRCA_all_data$vital_status)),col=c(&quot;orange&quot;,&quot;blue&quot;),
        legend.text=c(&quot;Vivos&quot;,&quot;Muertos&quot;),ylim=c(0,0.8),main=&quot;Mujeres con cancer de mama&quot;,   ylab =&quot;Frecuencias Relativas&quot;,las=1,font.axis=4)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-28-1.png" width="432" /></p>
</div>
</div>
<div id="pie" class="section level2">
<h2><span class="header-section-number">3.4</span> pie()</h2>
<p>Aporta la misma información que el diagrama de barras, pero en forma de diagrama de torta:</p>
<pre class="r"><code>library(Lock5Data)
data(HappyPlanetIndex)
attach(HappyPlanetIndex)
RegionLabels&lt;-c(&quot;South America&quot;, &quot;North America&quot;, &quot;North Africa&quot;, &quot;South Africa&quot;, &quot;India&quot;, &quot;Asia&quot;, &quot;East Europe&quot;)
pie(table(Region), RegionLabels, col = rainbow(length(table(Region))))
legend(&quot;topright&quot;, RegionLabels, cex = 0.8, fill = rainbow(length(table(Region))))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-29-1.png" width="432" /></p>
<p>El paquete <code>plotrix</code> permite elaborar diagramas de torta en 3D mediante la función <code>pie3D</code>:</p>
<pre class="r"><code>pie3D(table(Region))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-30-1.png" width="432" /></p>
<pre class="r"><code>pie3D(table(Region), explode = 0.1, main=&quot;Cantidad de paises incluidos en el estudio&quot;, labels = RegionLabels, labelcex = 0.9)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-31-1.png" width="432" /></p>
</div>
<div id="comparacion-de-funciones-de-densidad" class="section level2">
<h2><span class="header-section-number">3.5</span> comparación de funciones de densidad</h2>
<p>En ocasiones es necesario visualizar el comportamiento de dos distribuciones normales. En concreto, puede resultar interesantes saber <strong><em>cuán diferentes son</em></strong>. Vamos a mostrar esto con un ejemplo.</p>
<p>Vamos a generar un data.frame con 400 pacientes con 2 columnas:</p>
<ul>
<li>200 mujeres y 200 hombres.</li>
<li>la 1er columna contiene el género.</li>
<li>la 2da columna contiene la edad.</li>
<li>las mujeres tendrán una media de edad de 55 años.</li>
<li>los hombres tendrán una media de edad de 65 años.</li>
</ul>
<pre class="r"><code>set.seed(1234)
df &lt;- data.frame(
  sex=factor(rep(c(&quot;F&quot;, &quot;M&quot;), each=200)),
  weight=round(c(rnorm(200, mean=55, sd=5),
                 rnorm(200, mean=65, sd=5)))
  )</code></pre>
<ol style="list-style-type: decimal">
<li>Vamos a graficar la función de densidad de toda la muestra:</li>
</ol>
<pre class="r"><code>library(ggplot2)

p &lt;- ggplot(df, aes(x=weight)) + 
  geom_density()
p</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-33-1.png" width="432" /></p>
<pre class="r"><code># Agregamos una línea para la media y 
# una regla (rug) en el eje x que indica dónde caen los datos.
p+ geom_vline(aes(xintercept=mean(weight)),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1) + geom_rug()</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-33-2.png" width="432" /></p>
<pre class="r"><code># la regla es muy útiles cuando hay muchos datos para saber ver cómo es la densidad/cercanía de los datos.</code></pre>
<p>En la gráfica se ve cómo las dos funciones de densidad están solapadas.</p>
<pre class="r"><code>library(plyr)

# Vamos a calcular la media de cada grupo: 
mu &lt;- ddply(df, &quot;sex&quot;, summarise, grp.mean=mean(weight))

ggplot(df, aes(x=weight, fill=sex)) +
  geom_density()</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-34-1.png" width="432" /></p>
<pre class="r"><code># Indicamos un relleno semi-transparente:
p&lt;-ggplot(df, aes(x=weight, fill=sex)) +
  geom_density(alpha=0.4)
p</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-34-2.png" width="432" /></p>
<pre class="r"><code># Agregamos una línea para las medias de cada grupo:
p+geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
             linetype=&quot;dashed&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-34-3.png" width="432" /></p>
</div>
<div id="violin-plot" class="section level2">
<h2><span class="header-section-number">3.6</span> Violin plot</h2>
<p>Los datos del ejemplo anterior también se pueden ver con los gráficos <code>violin</code>, que visualizan la cantidad de datos en el ancho de la gráfica:</p>
<pre class="r"><code>ggplot(df, aes(sex, weight)) + 
  geom_violin(aes(fill = weight))</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-35-1.png" width="432" /></p>
</div>
<div id="boxplot" class="section level2">
<h2><span class="header-section-number">3.7</span> boxplot()</h2>
<div id="mi-primer-bloxplot" class="section level3">
<h3><span class="header-section-number">3.7.1</span> mi primer bloxplot</h3>
<p>Lleva a cabo la representación de diagramas de caja, también conocido como gráficos de “caja y bigote”. El objetivo de un <code>boxplot</code> es mostrar cómo se distribuyen los datos en una muestra. Un boxplot mostrará:</p>
<ul>
<li>la media.</li>
<li>los cuartiles de la muestra.</li>
<li>los puntos atípicos (outliers), si los hay.</li>
</ul>
<p>Veamos un ejemplo simple:</p>
<pre class="r"><code>x &lt;- seq(5, 15, length=1000) # generamos 1000 números entre 5 y 15
y &lt;- rnorm(x, mean=10, sd=3) # generamos 1000 números al azar.
# generamos 1000 datos al azar, con media 4 y desvío 2
# veamos los datos: 
summary(y)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.209   7.980   9.989   9.949  11.918  19.588</code></pre>
<p><code>Boxplot()</code> muestra la información de <code>summary()</code> de manera gráfica:</p>
<ul>
<li>el rectángulo muestra el rango de números que está entre el 1er y el 3er cuartil. O sea, grafica el conjunto del 75 % de los datos.</li>
<li>la media (Mean) es la línea que divide el rectángulo en dos.</li>
<li>el mínimo y el máximo son los extremos del eje Y.</li>
<li>los outliers están indicados con un punto.</li>
</ul>
<pre class="r"><code>boxplot(y)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-37-1.png" width="432" /></p>
<p>La misma información se puede ver en una función de densidad:</p>
<pre class="r"><code>plot(density(y)) # función de densidad &quot;empírica&quot;
curve(dnorm(x, mean=10, sd=3), add=TRUE, col=3) # la función de distribución de x</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-38-1.png" width="432" /></p>
<p>Si se “acuesta” el boxplot y se lo solapa sobre la función de distribución, debe coincidir la línea de la media (del boxplot) con el máximo de la función de densidad.</p>
</div>
<div id="boxplot-de-los-niveles-de-felicidad" class="section level3">
<h3><span class="header-section-number">3.7.2</span> boxplot de los niveles de felicidad</h3>
<p>El siguiente ejemplo muestra el reparto de los niveles de felicidad entre las distintas regiones del globo:</p>
<pre class="r"><code>library(Lock5Data)
data(HappyPlanetIndex)
attach(HappyPlanetIndex)
boxplot(Happiness~Region,col=&quot;gold&quot;,xlab=&quot;Region&quot;,ylab=&quot;Happiness level&quot;,
        main=&quot;Average happiness level by region&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-39-1.png" width="432" /></p>
</div>
<div id="persp" class="section level3">
<h3><span class="header-section-number">3.7.3</span> persp()</h3>
<p>Esta función realiza representaciones tridimensionales (superficies). El dataframe <code>volcano</code> que se distribuye junto con la instalación básica de R (ver <code>help(volcano)</code>) contiene información topográfica del volcán Maunga Whau en Auckland, Nueva Zelanda, definida sobre una malla de 870×610 metros, con un nodo cada 10 metros. Podemos trazar el perfil topográfico de este volcán mediante:</p>
<pre class="r"><code>persp(x = 10*(1:nrow(volcano)), y=10*(1:ncol(volcano)), z=3*volcano, 
      theta = 135, phi = 30, col = &quot;green3&quot;, scale = FALSE,
      ltheta = -120, shade = 0.75, border = NA, box = FALSE, main=&quot;Volcán Maunga Whau, Auckland, NZ&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-40-1.png" width="432" /></p>
</div>
</div>
</div>
<div id="mapas-de-calor" class="section level1">
<h1><span class="header-section-number">4</span> Mapas de calor</h1>
<pre class="r"><code>library(lattice)
library(gplots)

# generamos 4 matrices de 5x10, cada una: 
y &lt;- lapply(1:4, function(x) matrix(rnorm(50), 10, 5))

## Generaremos 4 variantes de mapas de calor:  
x1 &lt;- levelplot(y[[1]], col.regions=colorpanel(40, &quot;darkblue&quot;, &quot;yellow&quot;, &quot;white&quot;), main=&quot;colorpanel&quot;)
x2 &lt;- levelplot(y[[2]], col.regions=heat.colors(75), main=&quot;heat.colors&quot;)
x3 &lt;- levelplot(y[[3]], col.regions=rainbow(75), main=&quot;rainbow&quot;)
x4 &lt;- levelplot(y[[4]], col.regions=redgreen(75), main=&quot;redgreen&quot;)
print(x1, split=c(1,1,2,2))
print(x2, split=c(2,1,2,2), newpage=FALSE)
print(x3, split=c(1,2,2,2), newpage=FALSE)
print(x4, split=c(2,2,2,2), newpage=FALSE) </code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-41-1.png" width="432" /></p>
<div id="mapas-de-calor-con-agrupamiento" class="section level2">
<h2><span class="header-section-number">4.1</span> Mapas de calor con agrupamiento:</h2>
<pre class="r"><code>heatmap(y[[1]], scale = &quot;column&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-42-1.png" width="432" /></p>
</div>
</div>
<div id="dendogramas" class="section level1">
<h1><span class="header-section-number">5</span> Dendogramas</h1>
<p>En algunas circunstancias es necesario agrupar los datos y encontrar posibles similitudes entre ellos. El <strong><em>Análisis de Agrupación Jerárquico</em></strong> (hierarchical cluster analysis (HCA)) es una técnica que agrupa los datos en función de similitud. Para conocer más sobre HCA, sugerimos consultar <a href="https://www.datanovia.com/en/courses/hierarchical-clustering-in-r-the-essentials/">este material online</a>.</p>
<p>Para profundizar en paquetes, otras herramientas y parámetros no incluidos en este tutorial, recomendar <a href="http://www.sthda.com/english/wiki/beautiful-dendrogram-visualizations-in-r-5-must-known-methods-unsupervised-machine-learning">este hands-on</a>.</p>
<p>Usaremos un dataset incluido en la versión stantard de R. <code>USArrests</code> contiene 4 ratios de criminalidad de 50 estados de EEUU, del año 1973. Los ratios están expresados por cada 100.000 habitantes. También se incluye el porcentaje de la población que vive en áreas urbanas.</p>
<ol style="list-style-type: decimal">
<li>Carga de los datos</li>
</ol>
<pre class="r"><code>data(USArrests)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Cálculo de las distancias</li>
</ol>
<pre class="r"><code>dd &lt;- dist(scale(USArrests), method = &quot;euclidean&quot;) # cómputo de las distancias entre datos</code></pre>
<p>Se recomienda leer la ayuda de esta función: <code>?dist</code>. En este caso, optamos por utilizar la distancia euclidea aunque podríamos haber utilizado otra. Se puede ver la matriz resultante (NxN) con la instrucción <code>View(as.matrix(dd))</code>. Es lógico que la matriz diagonal (<code>diag(as.matrix(dd))</code>) sea 0 ya que no hay distancia entre un objeto y él mismo.</p>
<ol start="3" style="list-style-type: decimal">
<li>Construcción del agrupamiento jerárquico</li>
</ol>
<pre class="r"><code>hc &lt;- hclust(dd, method = &quot;ward.D2&quot;) #</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Visualización</li>
</ol>
<pre class="r"><code>plot(hc, hang = -1, cex = 0.6)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-46-1.png" width="432" /></p>
<p>Con <code>hang = -1</code> se indica que las hojas se muestren en el mismo nivel.</p>
<ol start="5" style="list-style-type: decimal">
<li>Ver el dendograma como árbol filogenético</li>
</ol>
<pre class="r"><code>library(&quot;ape&quot;)
plot(as.phylo(hc), type = &quot;unrooted&quot;, cex = 0.6,
     no.margin = TRUE)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-47-1.png" width="432" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Otro formato de visualizacion de árbol filogenético</li>
</ol>
<pre class="r"><code>plot(as.phylo(hc), type = &quot;fan&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-48-1.png" width="432" /></p>
<div id="particionamiento-del-dendograma" class="section level2">
<h2><span class="header-section-number">5.1</span> Particionamiento del dendograma</h2>
<p>Es posible establecer grupos y manejarlos de manera independiente. Por ejemplo:</p>
<pre class="r"><code>clus4 = cutree(hc, 4) # establecemos 4 clusters
which(clus4==1) # nos quedamos con los estados del 1º cluster</code></pre>
<pre><code>##        Alabama        Georgia      Louisiana    Mississippi North Carolina South Carolina 
##              1             10             18             24             33             40 
##      Tennessee 
##             42</code></pre>
<p>Se puede visualizar el corte en el dendograma con una línea:</p>
<pre class="r"><code>plot(hc, hang = -1, cex = 0.6)
abline(h = 4, lty = 2) # dibujar la línea en la altura 4. </code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-50-1.png" width="432" /></p>
</div>
</div>
<div id="importancia-de-los-colores" class="section level1">
<h1><span class="header-section-number">6</span> Importancia de los colores</h1>
<p>La correcta selección de colores es fundamental para conseguir visualizaciones elegantes y atractivas. En esta sección veremos el paquete <code>colortools</code>: una herramienta simple y potente que facilita paletas de colores.</p>
<div id="un-poco-de-teoria" class="section level2">
<h2><span class="header-section-number">6.1</span> Un poco de teoría</h2>
<p>La armonía entre colores está representada en la siguiente rueda de colores:</p>
<div class="figure">
<img src="http://www.sthda.com/sthda/RDoc/images/color-wheel.png" />

</div>
<p>Definiciones básicas:</p>
<ol style="list-style-type: decimal">
<li><p><strong><em>Monocromático</em></strong>: variaciones del mismo color.</p></li>
<li><p><strong><em>Análogo</em></strong>: los colores que se tocan en la rueda crean una combinación de colores armoniosa.</p></li>
<li><p><strong><em>Complementario</em></strong>: los colores de los extremos opuestos de la rueda proporcionan el mayor contraste.</p></li>
</ol>
<div class="figure">
<img src="http://www.sthda.com/sthda/RDoc/images/color-wheel-basics.png" />

</div>
<ol start="4" style="list-style-type: decimal">
<li><p><strong><em>División complementaria</em></strong>: una variación del esquema complementario que usa dos colores en cada lado de un color directamente complementario. Estos colores tienen un alto contraste visual pero con menos tensión visual que los colores puramente complementarios.</p></li>
<li><p><strong><em>Triádico</em></strong>: tres colores igualmente espaciados alrededor de la rueda de colores crean un interés visual intenso.</p></li>
<li><p><strong><em>Tetrádico</em></strong>: Dos pares de colores complementarios. Este esquema es popular porque ofrece un fuerte contraste visual al tiempo que conserva la armonía.</p></li>
</ol>
<div class="figure">
<img src="http://www.sthda.com/sthda/RDoc/images/color-wheel-basics-2.png" />

</div>
</div>
<div id="el-paquete-colortools" class="section level2">
<h2><span class="header-section-number">6.2</span> El paquete <code>colortools</code></h2>
<pre class="r"><code>library(colortools)</code></pre>
<ol style="list-style-type: decimal">
<li>Generar una rueda de colores sobre la base de un color</li>
</ol>
<pre class="r"><code>wheel(&quot;darkblue&quot;, num = 12)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-52-1.png" width="432" /></p>
<pre><code>##  [1] &quot;#00008B&quot; &quot;#46008B&quot; &quot;#8B008B&quot; &quot;#8B0046&quot; &quot;#8B0000&quot; &quot;#8B4500&quot; &quot;#8B8B00&quot; &quot;#468B00&quot; &quot;#008B00&quot;
## [10] &quot;#008B45&quot; &quot;#008B8B&quot; &quot;#00468B&quot;</code></pre>
<p>En el ejemplo anterior utilizamos el color <code>darkblue</code> y pedimos 12 variantes.</p>
<ol start="2" style="list-style-type: decimal">
<li>Generar colores adyacentes y análogos</li>
</ol>
<pre class="r"><code>adjacent(&quot;darkblue&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-53-1.png" width="432" /></p>
<pre><code>## [1] &quot;#00008B&quot; &quot;#46008B&quot; &quot;#00468B&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Generar colores complementarios</li>
</ol>
<pre class="r"><code>complementary(&quot;steelblue&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-54-1.png" width="432" /></p>
<pre><code>## [1] &quot;#4682B4&quot; &quot;#B47846&quot;</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Generar dos complementarios</li>
</ol>
<pre class="r"><code>splitComp(&quot;steelblue&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-55-1.png" width="432" /></p>
<pre><code>## [1] &quot;#4682B4&quot; &quot;#B4464B&quot; &quot;#B4AF46&quot;</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Generar el tetrádico</li>
</ol>
<pre class="r"><code>tetradic(&quot;steelblue&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-56-1.png" width="432" /></p>
<pre><code>## [1] &quot;#4682B4&quot; &quot;#7846B4&quot; &quot;#B47846&quot; &quot;#82B446&quot;</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Generar los colores cuadrados</li>
</ol>
<pre class="r"><code>square(&quot;steelblue&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-57-1.png" width="432" /></p>
<pre><code>## [1] &quot;#4682B4&quot; &quot;#AF46B4&quot; &quot;#B47846&quot; &quot;#4BB446&quot;</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Generar una gama de colores</li>
</ol>
<pre class="r"><code>sequential(&quot;steelblue&quot;)</code></pre>
<p><img src="Mod4_files/figure-html/unnamed-chunk-58-1.png" width="432" /></p>
<pre><code>##  [1] &quot;#B4B4B4FF&quot; &quot;#ABB0B4FF&quot; &quot;#A2ACB4FF&quot; &quot;#99A8B4FF&quot; &quot;#90A4B4FF&quot; &quot;#87A0B4FF&quot; &quot;#7E9BB4FF&quot; &quot;#7597B4FF&quot;
##  [9] &quot;#6C93B4FF&quot; &quot;#638FB4FF&quot; &quot;#5A8BB4FF&quot; &quot;#5187B4FF&quot; &quot;#4883B4FF&quot; &quot;#3F7FB4FF&quot; &quot;#367BB4FF&quot; &quot;#2D77B4FF&quot;
## [17] &quot;#2473B4FF&quot; &quot;#1B6EB4FF&quot; &quot;#126AB4FF&quot; &quot;#0966B4FF&quot; &quot;#0062B4FF&quot;</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Herramienta online</li>
</ol>
<p>Si quieres generar una paleta de colores con una herramienta online, puede utilizar <a href="http://colorschemedesigner.com/csd-3.5/">Color Scheme Designer</a>.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
